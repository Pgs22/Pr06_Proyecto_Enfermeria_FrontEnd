<div class="container d-flex justify-content-center align-items-center vh-100">
    <div class="card shadow-lg p-4" style="max-width: 450px; width: 100%;">
        
        <div class="text-center mb-4">
            <h3 class="card-title fw-bold text-primary">Register of nurse</h3>
            <img id="form-img" src="img/nurse_register.png" alt="Nurse Icon" class="img-fluid rounded-circle border border-3 border-primary" style="width: 120px; height: 120px; object-fit: cover;">
        </div>

        <!--To execute the function handleFormSubmit() as soon as I press the button on the form -->

        <form #registerForm="ngForm" (ngSubmit)="handleFormSubmit(registerForm)">
            
            <div class="mb-3">
                <label for="emailInput" class="form-label fw-semibold">
                    <i class="bi bi-envelope-fill me-1"></i> E-Mail:
                </label>
                <input 
                    id="emailInput"
                    name="email" 
                    class="form-control" 
                    [(ngModel)]="email"
                    #emailRef="ngModel"
                    type="email" 
                    required
                    required pattern="^[a-z0-9._%+\-]+@[a-z0-9.\-]+\.[a-z]{2,}$"
                    placeholder="usuario@dominio.com"                    
                >

                <span class="text-danger" [hidden]="emailRef.valid || emailRef.untouched">
                    <small>Format of email it isn't valid (for exemple: usuario@dominio.com)</small>
                </span>
            </div>
            
            <div class="mb-3">
                <label for="passwordInput" class="form-label fw-semibold">
                    <i class="bi bi-lock-fill me-1"></i> Password:
                </label>
                <input 
                    id="passwordInput"
                    name="password" 
                    class="form-control" 
                    [(ngModel)]="password" 
                    #passRef="ngModel"
                    type="password"
                    required
                    required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,64}"                 
                    placeholder="Min. 8 chars, 1 upper, 1 lower, 1 number"                    
                >

                <span class="text-danger" [hidden]="passRef.valid || passRef.untouched">
                    <small>Min. 8 chars, 1 upper, 1 lower and 1 number required.</small>
                </span>
            </div>
            
            <div class="mb-4">
                <label for="confirmPasswordInput" class="form-label fw-semibold">
                    <i class="bi bi-key-fill me-1"></i> Confirm Password:
                </label>
                <input 
                    id="confirmPasswordInput"
                    name="confirm_password" 
                    class="form-control" 
                    [(ngModel)]="confirm_password" 
                    #confirmRef="ngModel"
                    type="password"
                    required
                    required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,64}"                    
                    placeholder="Min. 8 chars, 1 upper, 1 lower, 1 number"                    
                >

                <span class="text-danger" [hidden]="(confirmRef.valid && confirm_password === password) || confirmRef.untouched">
                    <small>Passwords do not match.</small>
                </span>
            </div>
            <!--Disabled button if password it isn't correct or email is ivalid or confirmation password it isn'n diferent that password-->
            <div class="d-grid gap-2">
                <button 
                    class="btn btn-primary btn-lg" 
                    type="submit"
                    [disabled]="emailRef.invalid || passRef.invalid || password !== confirm_password"
                >
                    <i class="bi bi-person-plus-fill me-1"></i> Register

                </button>
                <a routerLink="/nurse-login" class="btn btn-outline-secondary">
                    <i class="bi bi-box-arrow-in-right me-1"></i> Login
                </a>
            </div>


            
        </form>

        <!--To display an error message if the data is invalid in the second validation, 
        configure the function that runs when the form is submitted, in nuser-register.ts--> 

        @if (is_registered_ok) {
            <div class="alert alert-success d-flex align-items-center mt-3" role="alert">              
                <i class="bi bi-check-circle-fill me-2"></i>
                <div>
                    @for (msg of register_message; track msg) {
                        <p class="mb-0"><strong>Success:</strong> {{ msg }}</p>
                    }
                </div>
            </div>
        }
        @if (is_registered_error) {
            <div class="alert alert-danger d-flex align-items-center mt-3" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <div>
                    @for (msg of register_message; track msg) {
                        <p class="mb-0"><strong>Error:</strong> {{ msg }}</p>
                    }
                </div>
            </div>

        }
    </div>
</div>